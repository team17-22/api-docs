openapi: 3.0.0
info:
  version: '1.3.0'
  title: 'EVP-api'
  description: 'api documentation for the EVP project'
  
servers:
  - description: 'Dev'
    url: 'http://localhost:8000/api'

paths:
  /project-statuses:
    get:
      summary: "Returns an array of possible project statuses"
      tags:
        - project
      responses:
        '200':
          description: Ok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectStatuses'
  /project-milestone-statuses:
    get:
      summary: "Returns an array of possible milestone statuses"
      tags:
        - project
      responses:
        '200':
          description: Ok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MilestoneStatuses'
  /project-home-types:
    get:
      summary: "Returns an array of possible project types for home projects"
      tags:
        - project
      responses:
        '200':
          description: Ok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectHomeTypes'              
  /project-foreign-types:
    get:
      summary: "Returns an array of possible project types for foreign projects"
      tags:
        - project
      responses:
        '200':
          description: Ok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectForeignTypes'
  /project-requests:
    get:
        summary: "Returns an array of possible project requests"
        tags:
          - project
        responses:
          '200':
            description: Ok
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ProjectRequests'
  /output-types:
    get:
        summary: "Returns an array of possible output types"
        tags:
          - outputs
        responses:
          '200':
            description: Ok
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ProjectOutputTypes'
  
  /project:
    post:
      summary: 'Creates new project'
      tags:
        - project
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  example: 'domestic'
                subtype:
                    type: string
                    example: 'KEGA'
                name_sk:
                  type: string
                  example: 'Názov projektu v slovenčine'
                name_en:
                    type: string
                    example: 'Name of the project in english'
                abstract:
                  type: string
                  example: 'Convolutional neural networks (CNNs) have been applied to various automatic image segmentation tasks in medical image analysis, including brain MRI segmentation...'
                keywords:
                  type: array
                  items:
                    type: string
                    example: "Adversarial networks"
                start_date:
                  type: string
                  example: '2020-12-12'
                end_date:
                  type: string
                  example: '2021-12-12'
                milestones:
                  type: array
                  items: 
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 0
                      name: 
                        type: string
                        example: 'Milnik 1'
                      description:
                        type: string
                        example: 'Nejaky milnik, idk, laldaldaldlal.'
                      date:
                        type: string
                        example: '2021-12-12' 
                outputs:
                  type: array
                  items: 
                    type: object
                    properties:
                      type:
                        type: integer
                        example: 1
                      count:
                        type: integer
                        example: 2
                      milestone_id:
                        type: integer
                        example: 0
                        
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewProject'
        '422':
          description: Unprocessable Entity
        '405':
          description: Method Not Allowed
  /project/{id}:
      get:
        summary: "Returns specified project"
        parameters:
            - in: path
              name: id
              schema:
                type: integer
                example: 1
              required: true
              description: ID of the project
        tags:
          - project
        responses:
          '200':
            description: Ok
            content:
              application/json:        
                schema:
                  $ref: '#/components/schemas/Project'
          '404':
            description: Not Found
  /project/{id}/milestones:
    get:
      summary: "Returns milestones for the specified project"
      tags:
        - project
      parameters:
          - in: path
            name: id
            schema:
              type: integer
              example: 1
            required: true
            description: ID of the project
      responses:
          '200':
            description: Ok
            content:
              application/json:        
                schema:
                  $ref: '#/components/schemas/ProjectMilestones'
          '404':
            description: Not Found
  /project-search:
    get:
      summary: "Returns projects"
      tags:
        - project
      parameters:
         - in: query
           name: page
           schema:
             type: integer
             example: 1
           description: Specify which page to return 
         - in: query
           name: limit
           schema:
             type: integer
             example: 10
           description: The numbers of items returned on each page
         - in: query
           name: title
           schema:
             type: string
             example: 'Nazov'
           description: Title
         - in: query
           name: keyword
           schema:
             type: string
             example: 'keyword1'
           description: Keyword
      responses:
        '200':
          description: OK
          content:
              application/json:        
                schema:
                  $ref: '#/components/schemas/ProjectSearch'
        '422':
          description: Unprocessable Content
       
  /person/{id}/projects-simple:
    get:
      summary: "Returns projects - simplified endpoint for team 25"
      tags:
        - "team25 endpoints"
      parameters:
          - in: path
            name: id
            schema:
              type: integer
              example: 1
            required: true
            description: ID of the user
          - in: query
            name: page
            schema:
              type: integer
            description: Specify which page to return 
          - in: query
            name: limit
            schema:
              type: integer
            description: The numbers of items returned on each page
      responses:
        '200':
          description: Ok
          content:
              application/json:        
                schema:
                  $ref: '#/components/schemas/SimplifiedProjects'
        '404':
          description: Not Found
       
  /person/{id}/projects:
    get:
      summary: "Returns projects of a user specified by ID"
      parameters:
          - in: path
            name: id
            schema:
              type: integer
              example: 1
            required: true
            description: ID of the user
      tags:
        - person
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      user:
                        type: object
                        properties:
                          id:
                            type: integer
                            example: 1
                          first_name:
                            type: string
                            example: John
                          last_name:
                            type: string
                            example: Doe
                          email:
                            type: string
                            example: john@doe.com
                          phone_number:
                            anyOf:
                              - type: string
                                example: 0901 234 567
                          my_projects:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 3
                                type:
                                  type: string
                                  example: domestic
                                subtype:
                                  type: string
                                  example: APPV
                                name_sk:
                                  type: string
                                  example: slovenský názov 3
                                name_en:
                                  type: string
                                  example: english title 3
                                start_date:
                                  type: string
                                  example: 2020-12-12
                                  format: date
                                end_date:
                                  type: string
                                  example: 2022-12-12
                                  format: date
                                is_draft:
                                  type: boolean
                                  example: false
                                status:
                                  type: string
                                  example: V realizácii
                                user_roles:
                                  type: array
                                  items:
                                    type: string
                                    example: project_user
                                user_roles_sk:
                                  type: array
                                  items:
                                    type: string
                                    example: Riešiteľ
                                active_member:
                                  type: boolean
                                  example: true
                          invitations:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 2
                                type:
                                  type: string
                                  example: foreign
                                subtype:
                                  type: string
                                  example: APPV
                                name_sk:
                                  type: string
                                  example: slovenský názov 2
                                name_en:
                                  type: string
                                  example: english title 2
                                start_date:
                                  type: string
                                  example: 2020-12-12
                                  format: date
                                end_date:
                                  type: string
                                  example: 2022-12-12
                                  format: date
                                is_draft:
                                  type: boolean
                                  example: false
                                status:
                                  type: string
                                  example: Podaný
                                user_roles:
                                  type: array
                                  items:
                                    type: string
                                    example: project_user
                                user_roles_sk:
                                  type: array
                                  items:
                                    type: string
                                    example: Riešiteľ
                                active_member:
                                  type: boolean
                                  example: false
                          drafts:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: integer
                                  example: 1
                                type:
                                  type: string
                                  example: domestic
                                subtype:
                                  type: string
                                  example: KEGA
                                name_sk:
                                  type: string
                                  example: slovenský názov 1
                                name_en:
                                  type: string
                                  example: english title 1
                                start_date:
                                  type: string
                                  example: 2020-12-12
                                  format: date
                                end_date:
                                  type: string
                                  example: 2022-12-12
                                  format: date
                                is_draft:
                                  type: boolean
                                  example: true
                                status:
                                  type: string
                                  example: Pred schválením
                                user_roles:
                                  type: array
                                  items:
                                    type: string
                                    example: project_admin
                                user_roles_sk:
                                  type: array
                                  items:
                                    type: string
                                    example: Hlavný riešiteľ
                                active_member:
                                  type: boolean
                                  example: false
        '404':
          description: Not found
            
components:
  schemas:
    ProjectStatuses:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 2
              status:
                type: string
                example: 'Pred schválením'

    MilestoneStatuses:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              status:
                type: string
                example: 'Plánovaný'
    
    ProjectHomeTypes:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 3
              status:
                type: string
                example: 'Grantový systém'
      
    ProjectForeignTypes:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 3
              status:
                type: string
                example: 'Negrantové zmluvy'

    ProjectRequests:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              status:
                type: string
                example: 'Výzva 1'

    ProjectOutputTypes:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              status:
                type: string
                example: 'Patent'
                
    NewProject:
      type: object
      properties:
        id: 
          type: integer
          example: 2132134
    
    ProjectMilestones:
      type: object
      properties:
        start_date:
          type: string
          format: date
          example: "2020-06-12"
        end_date:
          type: string
          format: date
          example: "2023-06-15"
        title:
          type: object
          properties:
            sk:
              type: string
              example: "slovensky nazov"
            en:
              type: string
              example: "english title"
        milestones:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              date:
                type: string
                format: date
                example: "2020-09-07"
              name:
                type: string
                example: "Milnik 1"
              description:
                type: string
                example: "Opis milniku 1."
              status:
                type: integer
                example: 1

    SimplifiedProjects:
      type: object
      properties:
        projects:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              title:
                type: string
                example: "slovensky nazov"
        info:
          type: object
          properties:
            number_of_results:
              type: integer
              example: 10
            number_of_returned:
              type: integer
              example: 1
            current_page:
              type: integer
              example: 2
            total_pages:
              type: integer
              example: 10
              
    Project:
      type: object
      properties:
        id:
          type: integer
          example: 1
        start_date:
          type: string
          format: date
          example: "2020-06-12"
        end_date:
          type: string
          format: date
          example: "2023-06-15"
        general_info:
          type: object
          properties:
            status:
              type: string
              example: "Pred schválením"
            type:
              type: string
              example: "KEGA"
        title:
          type: object
          properties:
            sk:
              type: string
              example: "slovensky nazov"
            en:
              type: string
              example: "english title"
        description:
          type: string
          example: "description lalal"
        milestones:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              date:
                type: string
                format: date
                example: "2020-09-07"
              name:
                type: string
                example: "Milnik 1"
              description:
                type: string
                example: "Opis milniku 1."
              status:
                type: integer
                example: 1
        keywords:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              keyword:
                type: string
                example: "Keyword 1"
        expected_results:
            type: array
            items:
              type: object
              properties:
                type:
                  type: string
                  example: 'Patent'
                total:
                  type: integer
                  example: 3
                concluded:
                  type: integer
                  example: 0
        participants:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              first_name:
                type: string
                example: "First"
              last_name:
                type: string
                example: "Last"
              contact:
                type: object
                properties:
                  email:
                    type: string
                    format: email
                    example: "lalal@mail.com"
                  phone_number:
                    type: string
                    example: "031236271"
                    
    ProjectSearch:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                example: 1
              title_sk:
                type: string
                example: "slovensky nazov"
              title_en:
                type: string
                example: "english title"
              type:
                type: string
                example: "KEGA"
              start_date:
                type: string
                format: date
                example: "2020-06-12"
              end_date:
                type: string
                format: date
                example:  "2023-06-15"
              status:
                type: string
                example: "Pred schválením"
        info:
          type: object
          properties:
            number_of_results:
              type: integer
              example: 1
            number_of_displayed:
              type: integer
              example: 1
            current_page:
              type: integer
              example: 1
            total_pages:
              type: integer
              example: 1